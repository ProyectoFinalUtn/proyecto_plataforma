CREATE DATABASE goguide ;
\connect goguide ;
CREATE EXTENSION postgis;

CREATE USER admin WITH PASSWORD 'proyecto2017';
GRANT ALL PRIVILEGES ON DATABASE goguide to admin;



------------------------------------
CREATE SEQUENCE public.admin_seq
    INCREMENT 1
    START 2
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;

ALTER SEQUENCE public.admin_seq
    OWNER TO postgres;
------------------------------------

--ADMIN 
CREATE TABLE public.administrador
(
    id bigint NOT NULL DEFAULT nextval('admin_seq'::regclass),
    nombre text COLLATE pg_catalog."default" NOT NULL,
    password text COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT administrador_pkey PRIMARY KEY (id),
    CONSTRAINT administrador_nombre_key UNIQUE (nombre)
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE public.administrador
    OWNER to postgres;

GRANT ALL ON TABLE public.administrador TO admin WITH GRANT OPTION;

GRANT ALL ON TABLE public.administrador TO postgres;
--INSERTO USUARIO CON PASSWORD 123
INSERT INTO administrador
values    ('admin','202cb962ac59075b964b07152d234b70');



--MENUS
CREATE TABLE public.menus
(
    id integer NOT NULL,
    name text COLLATE pg_catalog."default" NOT NULL,
    slug text COLLATE pg_catalog."default" NOT NULL,
    parent integer,
    "order" integer NOT NULL
)
WITH (
    OIDS = FALSE
)
TABLESPACE pg_default;

ALTER TABLE public.menus
    OWNER to postgres;

GRANT ALL ON TABLE public.menus TO admin WITH GRANT OPTION;



INSERT INTO menus (id, parent, name, icon, slug, number) VALUES
(1, NULL, 'Normativa', '', 'normativas', 1),
(2, NULL, 'Usuarios VANT', '', 'usuarios_vant', 2),
(3, NULL, 'Solicitudes de Excepcion', '', 'solicitudes_excepcion', 3),
(4, 1, 'Zonas de Influencia', '', 'zonas_influencia', 1),
(5, 1, 'Cargar Zonas', '', 'cargar_zonas', 2),
(6, 1, 'Zonas Temporales', '', 'zonas_temporales', 1),
(7, 2, 'Listar Usuarios', '', 'listar_usuarios', 2),
(8, 3, 'Listar Solicitudes', '', 'listar_solicitudes', 2);





